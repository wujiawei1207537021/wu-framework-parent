"use strict";(self.webpackChunklazy_ui=self.webpackChunklazy_ui||[]).push([[3371],{3371:function(e,l,a){a.r(l),a.d(l,{default:function(){return r}});var u=a(66252),t=a(2262);var r={__name:"MusicEdit",props:{showDialog:{type:Boolean,default:!0},title:{type:String,default:"添加"},rowData:{type:Object,default:null}},emits:["closeDialog"],setup(e,{emit:l}){const a={name:[{required:!0,message:"请输入音乐名称",trigger:"blur"}],singer:[{required:!0,message:"请输入歌手",trigger:"blur"}],album:[{required:!0,message:"请输入专辑",trigger:"blur"}],duration:[{required:!0,message:"请输入时长",trigger:"change"}]},r=e,o=l,{title:d,rowData:n}=(0,t.BK)(r),i=()=>{o("closeDialog",!1)},m=(0,t.iH)(null),p=(0,t.qj)({name:"",singer:"",album:"",duration:"",musicData:"",musicUrl:""}),{name:s,singer:c,album:f,duration:g,musicData:b,musicUrl:v}=(0,t.BK)(p);n.value&&(s.value=n.value.name,c.value=n.value.singer,f.value=n.value.album,g.value=n.value.duration,b.value=n.value.musicData,v.value=n.value.musicUrl),(0,u.bv)((async()=>{}));const w=e=>{var l=e.name,a=e.size;if(p.name=l,p.uid=e.uid,null!=a&&(p.length=(e=>{if(e<1024)return e+"B";if(e<1048576){let l=e/1024;return l=l.toFixed(2),l+"KB"}if(e<1073741824){let l=e/1048576;return l=l.toFixed(2),l+"MB"}{let l=e/1073741824;return l=l.toFixed(2),l+"GB"}})(a)),p.musicData=e.raw,null!==l){var u=l.split(".");p.type=u[u.length-1]}};return(l,r)=>{const o=(0,u.up)("el-input"),U=(0,u.up)("el-form-item"),V=(0,u.up)("el-button"),_=(0,u.up)("el-upload"),y=(0,u.up)("el-form"),h=(0,u.up)("el-dialog");return(0,u.wg)(),(0,u.j4)(h,{title:(0,t.SU)(d),"append-to-body":"","destroy-on-close":"","model-value":e.showDialog,onClose:r[8]||(r[8]=e=>i())},{footer:(0,u.w5)((()=>[(0,u._)("span",null,[(0,u.Wm)(V,{onClick:r[6]||(r[6]=e=>i())},{default:(0,u.w5)((()=>[(0,u.Uk)("取消")])),_:1}),(0,u.Wm)(V,{type:"primary",onClick:r[7]||(r[7]=e=>{m.value.validate((async e=>{if(!e)return console.log("error submit!!"),!1;{let e,l=new FormData;l.append("musicData",p.musicData),l.append("name",p.name),l.append("singer",p.singer),l.append("album",p.album),l.append("duration",p.duration),l.append("musicUrl",p.musicUrl),e="添加"===d.value?await VE_API.system.playMusicInsertOrUpdate(l):await VE_API.system.playMusicInsertOrUpdate({id:n.value.id,...l});const{code:a}=e;0===a&&i()}}))})},{default:(0,u.w5)((()=>[(0,u.Uk)("确定")])),_:1})])])),default:(0,u.w5)((()=>[(0,u.Wm)(y,{model:p,ref_key:"formRef",ref:m,rules:a,"label-width":"80px",inline:!1},{default:(0,u.w5)((()=>[(0,u.Wm)(U,{label:"音乐名称",prop:"name"},{default:(0,u.w5)((()=>[(0,u.Wm)(o,{modelValue:(0,t.SU)(s),"onUpdate:modelValue":r[0]||(r[0]=e=>(0,t.dq)(s)?s.value=e:null),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),(0,u.Wm)(U,{label:"歌手",prop:"singer"},{default:(0,u.w5)((()=>[(0,u.Wm)(o,{modelValue:(0,t.SU)(c),"onUpdate:modelValue":r[1]||(r[1]=e=>(0,t.dq)(c)?c.value=e:null),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),(0,u.Wm)(U,{label:"专辑",prop:"album"},{default:(0,u.w5)((()=>[(0,u.Wm)(o,{modelValue:(0,t.SU)(f),"onUpdate:modelValue":r[2]||(r[2]=e=>(0,t.dq)(f)?f.value=e:null),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),(0,u.Wm)(U,{label:"时长",prop:"duration"},{default:(0,u.w5)((()=>[(0,u.Wm)(o,{modelValue:(0,t.SU)(g),"onUpdate:modelValue":r[3]||(r[3]=e=>(0,t.dq)(g)?g.value=e:null),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),(0,u.Wm)(U,{label:"音乐地址",prop:"musicUrl"},{default:(0,u.w5)((()=>[(0,u.Wm)(o,{modelValue:(0,t.SU)(v),"onUpdate:modelValue":r[4]||(r[4]=e=>(0,t.dq)(v)?v.value=e:null),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),(0,u.Wm)(U,{label:"文件数据",prop:"musicData"},{default:(0,u.w5)((()=>[(0,u.Wm)(_,{name:"musicData",multiple:!1,"show-file-list":!0,"on-change":w,limit:"1",modelValue:(0,t.SU)(b),"onUpdate:modelValue":r[5]||(r[5]=e=>(0,t.dq)(b)?b.value=e:null),placeholder:"",clearable:"","auto-upload":!1},{default:(0,u.w5)((()=>[(0,u.Wm)(V,{size:"medium",type:"primary"},{default:(0,u.w5)((()=>[(0,u.Uk)("上传文件")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","model-value"])}}}}}]);