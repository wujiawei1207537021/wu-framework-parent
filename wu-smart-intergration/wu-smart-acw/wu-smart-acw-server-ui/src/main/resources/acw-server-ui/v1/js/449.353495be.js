"use strict";(self.webpackChunklazy_ui=self.webpackChunklazy_ui||[]).push([[449],{10449:function(e,l,a){a.r(l),a.d(l,{default:function(){return o}});var t=a(66252),u=a(2262);var o={__name:"ApplicationEdit",props:{showDialog:{type:Boolean,default:!0},title:{type:String,default:"添加"},rowData:{type:Object,default:null}},emits:["closeDialog"],setup(e,{emit:l}){const a={projectId:[{required:!0,message:"请输入选择项目",trigger:"blur"}],schemaName:[{required:!0,message:"请输入选择数据库",trigger:"blur"}],applicationName:[{required:!0,message:"请输入应用名",trigger:"blur"}]},o=e,i=l,{title:n,rowData:d}=(0,u.BK)(o),p=()=>{i("closeDialog",!1)},r=(0,u.iH)(null),c=(0,u.iH)(null),m=(0,u.iH)(null),s=(0,u.qj)({applicationName:"",projectId:"",applicationId:"",instanceId:"",schemaName:""}),{projectId:v,applicationName:f,applicationId:b,instanceId:w,schemaName:g}=(0,u.BK)(s);d.value&&(v.value=d.value.projectId,b.value=d.value.applicationId,w.value=d.value.instanceId,g.value=d.value.schemaName,f.value=d.value.applicationName);(0,t.bv)((async()=>{VE_API.system.projectList().then((e=>{e.data.map((e=>{e.label=e.projectName,e.value=e.id})),c.value=e.data?e.data:[]}))}));const I=e=>{if(console.log(e),e){(async(e=null)=>{if(null==e)return;let l=await VE_API.system.schemaList({instanceId:e});const{code:a}=l;0===a&&(l.data.map((e=>{e.label=e.schemaName,e.value=e.schemaName})),m.value=l.data?l.data:[])})(c.value.find((l=>l.id===e)).instanceId)}else m.value=[]};return(l,o)=>{const i=(0,t.up)("el-option"),b=(0,t.up)("el-select"),w=(0,t.up)("el-form-item"),h=(0,t.up)("el-input"),y=(0,t.up)("el-form"),_=(0,t.up)("el-button"),N=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.j4)(N,{title:(0,u.SU)(n),"append-to-body":"","destroy-on-close":"","model-value":e.showDialog,onClose:o[5]||(o[5]=e=>p())},{footer:(0,t.w5)((()=>[(0,t._)("span",null,[(0,t.Wm)(_,{onClick:o[3]||(o[3]=e=>p())},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(_,{type:"primary",onClick:o[4]||(o[4]=e=>{r.value.validate((async e=>{if(!e)return console.log("error submit!!"),!1;{let e;e="添加"===n.value?await VE_API.system.applicationAdd(s):await VE_API.system.applicationEdit({applicationId:d.value.applicationId,...s});const{code:l}=e;0===l&&p()}}))})},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(y,{model:s,ref_key:"formRef",ref:r,rules:a,"label-width":"80px",inline:!1},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{label:"项目名",prop:"projectId"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{modelValue:(0,u.SU)(v),"onUpdate:modelValue":o[0]||(o[0]=e=>(0,u.dq)(v)?v.value=e:null),placeholder:"项目名",onChange:I,clearable:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(c.value,(e=>((0,t.wg)(),(0,t.j4)(i,{key:e.value,label:e.label,value:e.value,serverId:e},null,8,["label","value","serverId"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(w,{label:"数据库",prop:"schemaName"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{modelValue:(0,u.SU)(g),"onUpdate:modelValue":o[1]||(o[1]=e=>(0,u.dq)(g)?g.value=e:null),placeholder:"数据库",clearable:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(m.value,(e=>((0,t.wg)(),(0,t.j4)(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(w,{label:"应用名",prop:"applicationName"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:(0,u.SU)(f),"onUpdate:modelValue":o[2]||(o[2]=e=>(0,u.dq)(f)?f.value=e:null),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","model-value"])}}}}}]);