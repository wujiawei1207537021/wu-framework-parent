"use strict";(self.webpackChunklazy_ui=self.webpackChunklazy_ui||[]).push([[6520],{56520:function(e,a,t){t.r(a),t.d(a,{default:function(){return f}});t(98858),t(61318),t(33228);var l=t(66252),n=t(2262),o=t(3577),u=t(49963);const r=(0,l._)("h4",null,"表对应的实体",-1),s={style:{"white-space":"pre-wrap"}},i=(0,l._)("h4",null,"实体对应xml",-1),m={style:{"white-space":"pre-wrap"}},c=(0,l._)("h4",null,"表对应的控制层",-1),d={style:{"white-space":"pre-wrap"}},p=(0,l._)("h4",null,"表对应的业务接口",-1),v={style:{"white-space":"pre-wrap"}},w=(0,l._)("h4",null,"表对应的业务接口实现",-1),h={style:{"white-space":"pre-wrap"}},b={data:()=>({description:"数据库表查询与设置",buttons:{search:{name:"查询"},add:{name:"添加表"},java_code:{name:"Java代码生成"},edit:{name:"编辑"},del:{name:"删除"},more:{name:"更多"},export_insert_sql:{name:"导出insert-sql"},export_upsert_sql:{name:"导出upsert-sql"},export_table_excel:{name:"导出表结构.excel"}},type:"1",icon:"CopyDocument",name:"数据库表查询与设置更多"})};var f=Object.assign(b,{__name:"DatabaseTableMore",props:{showDialog:{type:Boolean,default:!0},title:{type:String,default:"添加"},rowData:{type:Object,default:null}},emits:["closeDialog"],setup(e,{emit:a}){const t=(0,n.iH)(),b=e,f=a,{title:_,rowData:y}=(0,n.BK)(b),g=(0,n.iH)({}),k=()=>{f("closeDialog",!1)},x=(0,n.iH)(null),U=(0,n.qj)({id:"",schemaName:"",schemaNameId:"",instanceName:"",instanceId:"",engine:"",autoIncrement:"",tableComment:"",tableName:"",tableCatalog:"",tableRows:"",tableCollation:"",maxDataLength:"",indexLength:"",dataLength:"",avgRowLength:"",createOptions:"",checkTime:"",checksum:"",dataFree:"",rowFormat:"",tableType:"",createTime:"",updateTime:"",version:""}),{id:L,schemaName:I,schemaNameId:N,instanceName:z,instanceId:C,engine:W,autoIncrement:j,tableComment:R,tableName:E,tableCatalog:T,tableRows:D,tableCollation:P,maxDataLength:A,indexLength:S,dataLength:q,avgRowLength:O,createOptions:V,checkTime:F,checksum:M,dataFree:B,rowFormat:H,tableType:J,createTime:K,updateTime:Q,version:X}=(0,n.BK)(U),Y=(0,n.iH)(null);y.value&&(I.value=y.value.schemaName,L.value=y.value.id,N.value=y.value.schemaNameId,z.value=y.value.instanceName,C.value=y.value.instanceId,W.value=y.value.engine,j.value=y.value.autoIncrement,R.value=y.value.tableComment,E.value=y.value.tableName,T.value=y.value.tableCatalog,D.value=y.value.tableRows,P.value=y.value.tableCollation,A.value=y.value.maxDataLength,S.value=y.value.indexLength,q.value=y.value.dataLength,O.value=y.value.avgRowLength,V.value=y.value.createOptions,F.value=y.value.checkTime,M.value=y.value.checksum,B.value=y.value.dataFree,H.value=y.value.rowFormat,J.value=y.value.tableType,K.value=y.value.createTime,Q.value=y.value.updateTime,X.value=y.value.version);const G=(0,n.iH)([]),Z=(0,n.qj)({path:"/"}),$={label:"name",children:"children",isLeaf:"leaf"},ee=async(e,a)=>{if(0===e.level)return a([]);e.loaded=!0;var t=e.data;if(t.isFile)return a([]);console.log(t);const{code:l,data:n}=await VE_API.system.playFileResourceList({path:"/"===t.rootPath?"/"+t.name:t.rootPath+"/"+t.name});return 0===l?null==n?a([]):(n.map((e=>{e.value=e.absolutePath})),console.log(e),a(n)):void 0};return(0,l.bv)((async()=>{await(async()=>{const{code:e,data:a}=await VE_API.system.playFileResourceList(Z);0===e&&(a.map((e=>{e.value=e.absolutePath})),G.value=a)})(),VE_API.system.generateJavaModel({instanceId:y.value.instanceId,schemaName:y.value.schemaName,tableName:y.value.tableName}).then((e=>{const{code:a}=e;console.log(a),0===a&&(g.value=e.data)})),await(async()=>{let e=await VE_API.system.databaseTablesColumnList({instanceId:y.value.instanceId,schemaName:y.value.schemaName,tableName:y.value.tableName});const{code:a}=e;0===a&&(e.data.map((e=>{e.label=e.columnName,e.value=e.columnName})),Y.value=e.data?e.data:[])})()})),(a,b)=>{const f=(0,l.up)("el-tag"),L=(0,l.up)("el-descriptions-item"),I=(0,l.up)("el-descriptions"),N=(0,l.up)("el-divider"),z=(0,l.up)("el-tree-select"),C=(0,l.up)("el-button"),W=(0,l.up)("el-form-item"),j=(0,l.up)("el-card"),R=(0,l.up)("el-timeline-item"),E=(0,l.up)("el-timeline"),T=(0,l.up)("el-form"),D=(0,l.up)("el-drawer"),P=(0,l.Q2)("permission");return(0,l.wg)(),(0,l.j4)(D,{title:(0,n.SU)(_),"append-to-body":"","destroy-on-close":"","model-value":e.showDialog,onClose:b[7]||(b[7]=e=>k())},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{ref:"form"},{footer:(0,l.w5)((()=>[(0,l._)("span",null,[(0,l.Wm)(C,{onClick:b[5]||(b[5]=e=>k())},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(C,{type:"primary",onClick:b[6]||(b[6]=e=>{x.value.validate((async e=>{if(!e)return console.log("error submit!!"),!1;{let e;e="添加"===_.value?await VE_API.system.schemaAdd(U):await VE_API.system.schemaEdit({id:y.value.id,...U});const{code:a}=e;0===a&&k()}}))})},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(I,{class:"margin-top",column:3,border:"",title:"表详情"},{default:(0,l.w5)((()=>[(0,l.Wm)(L,{label:"数据库服务器ID"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(this.rowData.instanceId),1)])),_:1})])),_:1}),(0,l.Wm)(L,{label:"数据库服务器名称"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(this.rowData.instanceName),1)])),_:1})])),_:1}),(0,l.Wm)(L,{label:"数据库名称"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(this.rowData.schemaName),1)])),_:1}),(0,l.Wm)(L,{label:"表引擎"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(this.rowData.engine),1)])),_:1}),(0,l.Wm)(L,{label:"表名称"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(this.rowData.tableName),1)])),_:1}),(0,l.Wm)(L,{label:"表名描述"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(this.rowData.tableComment),1)])),_:1})])),_:1}),(0,l.Wm)(I,{border:""},{default:(0,l.w5)((()=>[(0,l.Wm)(L,{label:"表字段"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Y.value,((e,a)=>((0,l.wg)(),(0,l.iD)("span",{key:a},[(0,l.Uk)((0,o.zw)(e.columnName)+" ",1),(0,l.Wm)(N,{direction:"vertical"})])))),128))])),_:1}),(0,l.Wm)(L,{label:"生成本地Java代码地址"},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{modelValue:t.value,"onUpdate:modelValue":b[0]||(b[0]=e=>t.value=e),data:G.value,lazy:"",load:ee,props:$,filterable:"","check-strictly":"","render-after-expand":!1,"show-checkbox":"","check-on-click-node":""},null,8,["modelValue","data"])])),_:1})])),_:1}),(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.wy)(((0,l.wg)(),(0,l.j4)(C,{onClick:b[1]||(b[1]=(0,u.iM)((e=>((e,a=y.value)=>{y.value=a,VE_API.system.generateLocalJava({instanceId:y.value.instanceId,schemaName:y.value.schemaName,tableList:[y.value.tableName],absolutePath:t.value}).then((e=>{const{code:a}=e;0===a&&console.log(a)}))})(a.buttons.java_code.name,a.row)),["prevent"])),type:"primary",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.buttons.java_code.name),1)])),_:1})),[[P,["java_code"]]]),(0,l.wy)(((0,l.wg)(),(0,l.j4)(C,{onClick:b[2]||(b[2]=(0,u.iM)((e=>(async(e,a=y.value)=>{let t=await VE_API.system.tableExportInsertSql(a,{responseType:"blob"}),l=t.headers["file-name"];l=decodeURIComponent(l);let n=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.style.display="none",o.href=n,o.setAttribute("download",l),document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(o.href)})(a.buttons.export_insert_sql.name,a.row)),["prevent"])),type:"primary",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.buttons.export_insert_sql.name),1)])),_:1})),[[P,["export_insert_sql"]]]),(0,l.wy)(((0,l.wg)(),(0,l.j4)(C,{onClick:b[3]||(b[3]=(0,u.iM)((e=>(async(e,a=y.value)=>{let t=await VE_API.system.tableExportUpsertSql(a,{responseType:"blob"}),l=t.headers["file-name"];l=decodeURIComponent(l);let n=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.style.display="none",o.href=n,o.setAttribute("download",l),document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(o.href)})(a.buttons.export_upsert_sql.name,a.row)),["prevent"])),type:"primary",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.buttons.export_upsert_sql.name),1)])),_:1})),[[P,["export_upsert_sql"]]]),(0,l.wy)(((0,l.wg)(),(0,l.j4)(C,{onClick:b[4]||(b[4]=(0,u.iM)((e=>(async(e,a=y.value)=>{let t=await VE_API.system.exportTableStructureExcel(a,{responseType:"blob"}),l=t.headers["file-name"];l=decodeURIComponent(l);let n=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.style.display="none",o.href=n,o.setAttribute("download",l),document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(o.href)})(a.buttons.export_table_excel.name,a.row)),["prevent"])),type:"primary",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.buttons.export_table_excel.name),1)])),_:1})),[[P,["export_table_excel"]]])])),_:1}),(0,l.Wm)(E,null,{default:(0,l.w5)((()=>[(0,l.Wm)(R,{timestamp:"实体",placement:"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[r,(0,l._)("p",s,(0,o.zw)(g.value.javaEntity),1)])),_:1})])),_:1}),(0,l.Wm)(R,{timestamp:"实体对应xml",placement:"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[i,(0,l._)("p",m,(0,o.zw)(g.value.javaMapperXml),1)])),_:1})])),_:1}),(0,l.Wm)(R,{timestamp:"控制层",placement:"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[c,(0,l._)("p",d,(0,o.zw)(g.value.javaController),1)])),_:1})])),_:1}),(0,l.Wm)(R,{timestamp:"业务接口",placement:"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[p,(0,l._)("p",v,(0,o.zw)(g.value.javaService),1)])),_:1})])),_:1}),(0,l.Wm)(R,{timestamp:"业务接口实现",placement:"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(j,null,{default:(0,l.w5)((()=>[w,(0,l._)("p",h,(0,o.zw)(g.value.javaServiceImpl),1)])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1},8,["title","model-value"])}}})},50926:function(e,a,t){var l=t(23043),n=t(69985),o=t(6648),u=t(44201)("toStringTag"),r=Object,s="Arguments"===o(function(){return arguments}());e.exports=l?o:function(e){var a,t,l;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,a){try{return e[a]}catch(e){}}(a=r(e),u))?t:s?o(a):"Object"===(l=o(a))&&n(a.callee)?"Arguments":l}},62148:function(e,a,t){var l=t(98702),n=t(72560);e.exports=function(e,a,t){return t.get&&l(t.get,a,{getter:!0}),t.set&&l(t.set,a,{setter:!0}),n.f(e,a,t)}},23043:function(e,a,t){var l={};l[t(44201)("toStringTag")]="z",e.exports="[object z]"===String(l)},34327:function(e,a,t){var l=t(50926),n=String;e.exports=function(e){if("Symbol"===l(e))throw new TypeError("Cannot convert a Symbol value to a string");return n(e)}},21500:function(e){var a=TypeError;e.exports=function(e,t){if(e<t)throw new a("Not enough arguments");return e}},98858:function(e,a,t){var l=t(11880),n=t(68844),o=t(34327),u=t(21500),r=URLSearchParams,s=r.prototype,i=n(s.append),m=n(s.delete),c=n(s.forEach),d=n([].push),p=new r("a=1&a=2&b=3");p.delete("a",1),p.delete("b",void 0),p+""!="a=2"&&l(s,"delete",(function(e){var a=arguments.length,t=a<2?void 0:arguments[1];if(a&&void 0===t)return m(this,e);var l=[];c(this,(function(e,a){d(l,{key:a,value:e})})),u(a,1);for(var n,r=o(e),s=o(t),p=0,v=0,w=!1,h=l.length;p<h;)n=l[p++],w||n.key===r?(w=!0,m(this,n.key)):v++;for(;v<h;)(n=l[v++]).key===r&&n.value===s||i(this,n.key,n.value)}),{enumerable:!0,unsafe:!0})},61318:function(e,a,t){var l=t(11880),n=t(68844),o=t(34327),u=t(21500),r=URLSearchParams,s=r.prototype,i=n(s.getAll),m=n(s.has),c=new r("a=1");!c.has("a",2)&&c.has("a",void 0)||l(s,"has",(function(e){var a=arguments.length,t=a<2?void 0:arguments[1];if(a&&void 0===t)return m(this,e);var l=i(this,e);u(a,1);for(var n=o(t),r=0;r<l.length;)if(l[r++]===n)return!0;return!1}),{enumerable:!0,unsafe:!0})},33228:function(e,a,t){var l=t(67697),n=t(68844),o=t(62148),u=URLSearchParams.prototype,r=n(u.forEach);l&&!("size"in u)&&o(u,"size",{get:function(){var e=0;return r(this,(function(){e++})),e},configurable:!0,enumerable:!0})}}]);