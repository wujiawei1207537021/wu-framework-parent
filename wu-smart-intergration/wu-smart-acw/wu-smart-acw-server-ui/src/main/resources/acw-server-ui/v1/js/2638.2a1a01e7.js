"use strict";(self.webpackChunklazy_ui=self.webpackChunklazy_ui||[]).push([[2638],{86575:function(e,a){a.Z={description:"数据库管理平台",type:"1",icon:"DataLine",name:"数据库管理平台"}},32638:function(e,a,l){l.r(a),l.d(a,{default:function(){return r}});var t=l(66252),n=l(2262),u=l(86575);const i={class:"ve_container"},d={style:{padding:"10px 0"}},o=(0,t._)("p",{style:{"margin-top":"10px","font-size":"14px"}}," 点击或拖拽文件至此即可上传文件 ",-1),s=(0,t._)("p",{style:{"margin-top":"20px","font-size":"14px",color:"red"}}," 请上传10GB以内的待测对象 ",-1),m={data:()=>({description:"数据库信息导入",buttons:{search:{name:"查询"},add:{name:"添加"},edit:{name:"编辑"},del:{name:"删除"},analysisSchema:{name:"解析schema"}},type:"1",icon:"MagicStick",name:"数据库信息导入",parentMenu:u.Z})};var r=Object.assign(m,{__name:"AcwSchemaImportData",setup(e){const a={name:[{required:!0,message:"请输入文件名称",trigger:"blur"}],data:[{required:!0,message:"请上传文件",trigger:"blur"}],type:[{required:!0,message:"请选择文件类型",trigger:"blur"}]},l=(0,n.iH)(null),u=(0,n.qj)({schema:"",instanceId:"",data:[]}),{schema:m,instanceId:r,data:p}=(0,n.BK)(u),c=(0,n.iH)(null),f=(0,n.iH)(null);(0,t.bv)((async()=>{VE_API.system.databaseInstanceList().then((e=>{e.data.map((e=>{e.label=e.instanceName,e.value=e.id})),c.value=e.data?e.data:[]}))}));const h=e=>{var a=e.name,l=e.size;if(u.name=a,u.uid=e.uid,null!=l&&(u.length=(e=>{if(e<1024)return e+"B";if(e<1048576){let a=e/1024;return a=a.toFixed(2),a+"KB"}if(e<1073741824){let a=e/1048576;return a=a.toFixed(2),a+"MB"}{let a=e/1073741824;return a=a.toFixed(2),a+"GB"}})(l)),u.data=e.raw,null!==a){var t=a.split(".");u.type=t[t.length-1]}};return(e,g)=>{const v=(0,t.up)("el-option"),b=(0,t.up)("el-select"),y=(0,t.up)("el-form-item"),w=(0,t.up)("Icon"),_=(0,t.up)("el-upload"),I=(0,t.up)("el-form"),V=(0,t.up)("el-button");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t.Wm)(I,{model:u,ref_key:"formRef",ref:l,rules:a,"label-width":"80px",inline:!1},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{label:"数据库实例",prop:"instanceId"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{modelValue:(0,n.SU)(r),"onUpdate:modelValue":g[0]||(g[0]=e=>(0,n.dq)(r)?r.value=e:null),placeholder:"数据库实例",filterable:"",onChange:g[1]||(g[1]=e=>((e=null)=>{console.log(e),VE_API.system.schemaList({instanceId:r.value}).then((e=>{e.data.map((e=>{e.label=e.schemaName,e.value=e.schemaName})),f.value=e.data?e.data:[]}))})(e))},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(c.value,(e=>((0,t.wg)(),(0,t.j4)(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(y,{label:"数据库库名",prop:"schemaName"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{modelValue:(0,n.SU)(m),"onUpdate:modelValue":g[2]||(g[2]=e=>(0,n.dq)(m)?m.value=e:null),filterable:"",placeholder:"数据库实例",onChange:e.findInstanceSchemaColumnList},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(f.value,(e=>((0,t.wg)(),(0,t.j4)(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,t.Wm)(y,{label:"文件数据",prop:"data"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{name:"data",multiple:!1,"show-file-list":!0,"on-change":h,limit:"1",modelValue:(0,n.SU)(p),"onUpdate:modelValue":g[3]||(g[3]=e=>(0,n.dq)(p)?p.value=e:null),placeholder:"",clearable:"","auto-upload":!1},{default:(0,t.w5)((()=>[(0,t._)("div",d,[(0,t.Wm)(w,{type:"ios-cloud-upload",size:"52",style:{}}),o,s])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,t._)("span",null,[(0,t.Wm)(V,{type:"primary",onClick:g[4]||(g[4]=e=>{l.value.validate((async e=>{if(!e)return console.log("error submit!!"),!1;{let e=new FormData;e.append("multipartFileList",u.data),e.append("instanceId",u.instanceId),e.append("schema",u.schema);let a=await VE_API.system.aceSchemaImportData(e);const{code:l}=a;0===l&&console.log(l)}}))})},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1})])])}}})}}]);